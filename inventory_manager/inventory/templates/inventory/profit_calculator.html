{% extends 'base.html' %}

{% block title %}Kâr Hesaplama{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Kâr Hesaplama</h2>
    <form id="profit-form" method="POST" action="{% url 'save_profit_calculation' %}">
        {% csrf_token %}
        <div class="mb-3">
            <label for="barcode" class="form-label">Barkod</label>
            <input type="text" id="barcode" name="barcode" class="form-control" value="{{ barcode }}" readonly>
        </div>
        <div class="mb-3">
            <label for="selling-price" class="form-label">Satış Fiyatı</label>
            <input type="number" class="form-control" id="selling-price" name="selling_price" placeholder="Satış Fiyatı" value="{{ selling_price }}" required>
        </div>

        {% if request.session.is_logged_in %}
        <div class="mb-3">
            <label for="commission-rate" class="form-label">Komisyon Oranı (%)</label>
            <input type="number" class="form-control" id="commission-rate" name="commution" placeholder="Komisyon Oranı" value="{{ commution }}" required>
        </div>
        <div class="mb-3">
            <label for="purchase-cost" class="form-label">Alış / Üretim Maliyeti</label>
            <input type="number" class="form-control" id="purchase-cost" name="purchase_cost" placeholder="Maliyet" required>
        </div>
        <div class="mb-3">
            <label for="shipping-cost" class="form-label">Kargo Maliyeti</label>
            <input type="number" class="form-control" id="shipping-cost" name="shipping_cost" placeholder="Kargo Maliyeti" required>
        </div>
        <div class="mb-3">
            <label for="packaging-cost" class="form-label">Paketleme Maliyeti</label>
            <input type="number" class="form-control" id="packaging-cost" name="packaging_cost" placeholder="Paketleme Maliyeti" required>
        </div>
        <div class="mb-3">
            <label for="other-costs" class="form-label">Diğer Maliyetler</label>
            <input type="number" class="form-control" id="other-costs" name="other_costs" placeholder="Diğer Maliyetler" required>
        </div>
        <div class="mb-3">
            <label for="vat-rate" class="form-label">KDV Oranı (%)</label>
            <input type="number" class="form-control" id="vat-rate" name="vat_rate" placeholder="KDV Oranı" required>
        </div>

        <button type="button" class="btn btn-success" onclick="calculateProfit()">Hesapla</button>
        <button type="button" class="btn btn-secondary" onclick="clearForm()">Temizle</button>
        <button type="submit" class="btn btn-primary">Ekle</button>
        {% else %}
        <div class="alert alert-warning">
            Detaylı kâr hesaplaması yapabilmek için giriş yapmanız gerekmektedir.
        </div>
        {% endif %}
    </form>

    {% if request.session.is_logged_in %}
    <div class="mt-4">
        <h4>Sonuçlar</h4>
        <p>Ödediğiniz Komisyon: <span id="paid-commission">0</span> TL</p>
        <p>Ödediğiniz KDV: <span id="paid-vat">0</span> TL</p>
        <p>Toplam Maliyet: <span id="total-cost">0</span> TL</p>
        <p>Net Kâr: <span id="net-profit">0</span> TL</p>
        <p>Yüzde Kâr: <span id="profit-margin">0</span>%</p>
    </div>
    {% endif %}
</div>
</div>

<script>
// JavaScript kodları aynı kalabilir
</script>

{% endblock %}