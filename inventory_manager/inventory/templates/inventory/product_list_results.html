<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>#</th>
            <th>Image</th>  <!-- New column for image -->
            <th>Name</th>
            <th>Barcode</th>
            <th>
                <a href="?{% if query %}q={{ query }}&{% endif %}sort_by=purchase_price&sort_order={% if sort_by == 'purchase_price' and sort_order == 'asc' %}desc{% else %}asc{% endif %}">
                    Purchase Price
                    {% if sort_by == 'purchase_price' %}
                        {% if sort_order == 'asc' %}
                            <i class="fa fa-arrow-up"></i>
                        {% else %}
                            <i class="fa fa-arrow-down"></i>
                        {% endif %}
                    {% endif %}
                </a>
            </th>
            <th>
                <a href="?{% if query %}q={{ query }}&{% endif %}sort_by=selling_price&sort_order={% if sort_by == 'selling_price' and sort_order == 'asc' %}desc{% else %}asc{% endif %}">
                    Selling Price
                    {% if sort_by == 'selling_price' %}
                        {% if sort_order == 'asc' %}
                            <i class="fa fa-arrow-up"></i>
                        {% else %}
                            <i class="fa fa-arrow-down"></i>
                        {% endif %}
                    {% endif %}
                </a>
            </th>
            <th>
                <a href="?{% if query %}q={{ query }}&{% endif %}sort_by=stock&sort_order={% if sort_by == 'stock' and sort_order == 'asc' %}desc{% else %}asc{% endif %}">
                    Stock
                    {% if sort_by == 'stock' %}
                        {% if sort_order == 'asc' %}
                            <i class="fa fa-arrow-up"></i>
                        {% else %}
                            <i class="fa fa-arrow-down"></i>
                        {% endif %}
                    {% endif %}
                </a>
            </th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for product in page_obj %}
        <tr id="product-{{ product.id }}">
            <td>{{ product.id }}</td>
            <td>
                {% if product.image_url %}
                    <img src="{{ product.image_url }}" alt="{{ product.name }}" style="width: 110px; height: 144px;">
                {% else %}
                    No Image
                {% endif %}
            </td>
            <td>{{ product.name }}</td>
            <td>{{ product.barcode }}</td>
            <td>${{ product.purchase_price }}</td>
            <td>${{ product.selling_price }}</td>
            <td id="stock-{{ product.id }}">{{ product.stock }}</td>
            <td>
                <form method="post" action="{% url 'adjust_stock' product.id 1 %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success btn-sm">+1 Stock</button>
                </form>
                <form method="post" action="{% url 'adjust_stock' product.id -1 %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm">-1 Stock</button>
                </form>
                <a href="{% url 'edit_product' product.id %}" class="btn btn-warning btn-sm">Edit</a>
                <form method="post" action="{% url 'delete_product' product.id %}" style="display:inline;" onsubmit="return confirmDelete(this);">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-secondary btn-sm">Delete</button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="8" class="text-center">No products available.</td>  <!-- Updated colspan -->
        </tr>
        {% endfor %}
    </tbody>
</table>
<!-- Pagination controls -->
<nav aria-label="Page navigation">
    <ul class="pagination">
        {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page=1{% if query %}&q={{ query }}{% endif %}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" aria-label="First">
                    <span aria-hidden="true">&laquo;&laquo;</span>
                </a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if query %}&q={{ query }}{% endif %}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
        {% endif %}
        {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}{% if query %}&q={{ query }}{% endif %}&sort_by={{ sort_by }}&sort_order={{ sort_order }}">{{ num }}</a></li>
            {% endif %}
        {% endfor %}
        {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if query %}&q={{ query }}{% endif %}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" aria-label="Last">
                    <span aria-hidden="true">&raquo;&raquo;</span>
                </a>
            </li>
        {% endif %}
    </ul>
</nav>